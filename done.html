<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script src="common.js"></script>

<h3>☑ 未完了の宿題</h3>
<div id="list">読み込み中...</div>
<button onclick="done()">完了にする</button>

<script>
let undone=[];

async function start(){
  await liffInit();
  undone = await post({ action:"getUndoneHomework", userId });
  list.innerHTML="";
  undone.forEach(t=>{
    list.innerHTML+=`
      <label>
        <input type="checkbox" value="${t}"> ${t}
      </label><br>`;
  });
}

async function done(){
  const checked=[...document.querySelectorAll("input:checked")].map(c=>c.value);
  if(!checked.length){ alert("選択してください"); return; }
  await post({ action:"doneHomework", userId, doneList:checked });
  liff.closeWindow();
}
start();
</script>
